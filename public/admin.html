<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600&family=Fredoka+One&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    body {font-family: 'Poppins', sans-serif;background-color: #ffe6f3;margin: 0; color: #d23481;}
    .container { display: flex; min-height: 100vh; }
    .sidebar { width: 80px; border-right: 2px solid #d23481; display: flex; flex-direction: column; align-items: center; padding: 1rem 0; gap: 2rem;background-color: #ffe6f3;border-radius: 0 16px 16px 0;}
    .logo {margin-bottom:1rem;}
    .logo img { width:36px; height:36px;}
    .left-buttons { display:flex; flex-direction:column; align-items:center; gap:3rem; width:100%;}
    .left-buttons button {background:none; border:none; color:#d23481; cursor:pointer; font-weight:600; font-size:0.85rem; display:flex; flex-direction: column; align-items:center; gap:0.3rem;padding: 0.2rem 0;transition: color 0.3s;}
    .left-buttons button:hover {color: #0e0107;}
    .left-buttons button.active {color: #ea5a9f;font-weight: 700;}
    .left-buttons button img { width:24px; height:24px;}
    .main-content { flex-grow:1; padding:1.5rem 2rem; display:flex; flex-direction:column;}
    .topbar { display:flex; align-items:center; justify-content:space-between; margin-bottom:1.5rem;}
    .topbar h1 { font-family:'Fredoka One',cursive; font-size:40px; font-weight:900; color:#d23481; margin:0; letter-spacing:-1px;}
    .right-buttons { display:flex; align-items:center; gap:1rem; }
    .right-buttons button { display:flex; align-items:center; gap:0.5rem; font-weight:600; font-size:1rem; border-radius:12px; padding:0.5rem 1rem; cursor:pointer; border:2px solid #d23481; background-color:#fff; color:#d23481; transition:background-color 0.3s,color 0.3s;}
    .right-buttons button img { width:28px; height:28px;}
    .right-buttons button:hover, .admin-btn { background-color:#d23481; color:#fff; border:2px solid #d23481; }
    .subnav { display:flex; border-bottom:2px solid #d23481; margin-bottom:1.5rem; gap:2rem; font-size:0.93rem;}
    .subnav button { background:none; border:none; cursor:pointer; padding-bottom:0.5rem; color:#d23481; border-bottom:3px solid transparent;}
    .subnav button.active { border-bottom:3px solid #d23481; font-weight:700;}
    /* Usage Stats Panel */
    .stats {display:flex; gap:1.5rem; margin-bottom:2rem;}
    .stat-card { background:white; border:1.5px solid #f4c1d9; border-radius:12px; padding:1.5rem 2rem; flex:1;}
    .stat-card h3 { margin-top:0; font-weight:700; font-size:1.2rem; color:#d23481; margin-bottom:0.5rem;}
    .number { font-size:2.8rem; font-weight:900; margin:0.2rem 0 0.5rem; color:black;}
    .growth { color:#7fc97f; font-weight:600; font-size:0.9rem;}
    .growth i { margin-right:0.3rem;}
    .charts {display:flex; gap:1.5rem;}
    .chart-card { background:white; flex:1; border-radius:12px; padding:1rem 1.5rem; border:1.5px solid #f4c1d9;}
    .chart-card h3 { margin-top:0; color:#d23481; font-weight:700;}
    .chart-placeholder { height:120px; background:transparent; border:none; border-radius:8px; display:flex; justify-content:center; align-items:center; font-weight:600; color:#d23481; margin-top:0.8rem;}
    /* Template Management Panel */
    .template {display:flex; gap:1.5rem; margin-bottom:1rem; align-items:center;}
    .upload-btn { flex:0 0 300px; height:120px; border-radius:16px; border:none; color:#fff; font-size:1.5rem; font-weight:bold; cursor:pointer;background: linear-gradient(90deg, #fa49c5 0%, #ffe86b 100%);display:flex; flex-direction:column; justify-content:center; align-items:center;}
    .upload-btn:hover {background: linear-gradient(90deg, #f4b744 0%, #f645b1 100%);}
    .template-search {flex:1; display:flex; flex-direction:column; gap:.7rem;}
    .template-search-row-top {display:flex; gap:1rem; margin-bottom:.3rem;}
    .template-search-row-top input[type="text"] { flex:1; padding:0.9rem 1rem; font-size:1.05em; border-radius:9px; border:1.7px solid #e10994; outline:none;}
    .template-search-row-bottom {display:flex; gap:1rem; align-items:center;}
    .template-search-row-bottom label { font-weight:bold; margin-right:0.3rem; color:#e10994; font-size:1.05em;}
    .template-search-row-bottom select {padding:0.6rem 1rem; border-radius:8px; border:1.7px solid #fa49c5; font-size:1em; outline:none;}
    .template-search-row-bottom input[type="date"] {padding:0.3rem 0.5rem; border-radius:8px; border:1.7px solid #fa49c5; font-size:1em; outline:none;}
    .template-table { width:100%; border-collapse:collapse; background:#fffafb; margin-top:1.3rem; border-radius:12px; overflow:hidden;}
    .template-table thead tr {background:#fde1f2;}
    .template-table th, .template-table td {padding:1rem; text-align:left; font-size:1.07em; border-bottom:2px solid #fcc2f2;}
    .template-table th { color:#e10994; font-weight:bold;}
    .template-table tbody tr {border-bottom:1px solid #fadcea;}
    .template-table tbody tr:last-child { border-bottom:none;}
    .template-table td { color:#d23481; }
    .template-table td .action-icon {margin-right:.8rem; cursor:pointer; opacity:0.90; vertical-align:middle; width:20px; height:20px; transition:opacity .2s;}
    .template-table td .action-icon:last-child {margin-right:0;}
    .template-table td .action-icon:hover { opacity:1;}
    
    /* Modal styles with scroll */
    .modal-overlay {position: fixed;top: 0; left: 0; right: 0; bottom: 0;background: rgba(128, 128, 128, 0.6);display: flex;justify-content: center;align-items: center;z-index: 1000;overflow-y: auto; padding: 1rem;  }
    .modal {background: #fff;padding: 2rem 2.5rem;border-radius: 12px;width: 520px;max-height: 90vh;overflow-y: auto;font-family: 'Poppins', sans-serif;box-shadow: 0 8px 25px rgba(210, 52, 129, 0.25);box-sizing: border-box;position: relative;}
    #uploadModal .modal {width: 750px;max-height: none;overflow-y: visible;padding: 1.8rem 2.5rem;}
    .modal h2 {font-family: 'Fredoka One', cursive;font-size: 28px;font-weight: 900;color: #ea3b91;margin: 0 0 1rem 0;}
    label {font-weight: 600;font-size: 0.93rem;color: #ea3b91;margin-bottom: 0.3rem;display: block;}
    input[type="text"],
    select {width: 100%;padding: 0.55rem 1rem;font-size: 1rem;border: 1.5px solid #f9c6dd;border-radius: 10px;outline: none;margin-bottom: 0.8rem;color: #d23481;}
    input[type="text"]::placeholder {color: #f9b6d4;font-weight: 500;}
    .upload-instruction {margin-bottom: 0.5rem;color: #d23481;font-weight: 600;}
    #editDualUploadContainer .upload-instruction {color: #8BC34A;}
    .upload-form-row {display: flex;gap: 1rem;margin-bottom: 0.8rem;}
    .upload-form-row .form-group {flex: 1;}
    .upload-form-row label {margin-bottom: 0.5rem;}
    .upload-form-row input, .upload-form-row select {width: 100%;}
    .dual-upload-group {display: flex;flex-direction: column;gap: 0.8rem;margin-bottom: 0.8rem;}
    .dual-upload-item {border: 1px solid #f0c6d9;padding: 1rem;border-radius: 12px;display: flex;flex-direction: column;justify-content: center;align-items: center;text-align: center;color: #d23481;font-weight: 600;gap: 0.5rem;min-height: auto;background: transparent;cursor: pointer;transition: background 0.2s;}
    #editDualUploadContainer .dual-upload-item:hover {background: #faf8fa;}
    .dual-upload-item input[type="file"] {display: none;}
    .single-upload-box {border: 1.5px dashed #f9c6dd;padding: 1.2rem;border-radius: 14px;display: flex;flex-direction: column;justify-content: center;align-items: center;text-align: center;margin-bottom: 0.8rem;min-height: 65px;}
    .single-upload-box input[type="file"] {display: none;}
    .upload-label {background: linear-gradient(90deg, #ea3b91 0%, #fec74f 100%);border-radius: 14px;padding: 0.5rem 1rem;color: white;font-weight: 700;cursor: pointer;user-select: none;transition: filter 0.3s ease;}
    .upload-label:hover {background: linear-gradient(90deg, #f4b744 0%, #f645b1 100%);}
    .status-group {margin-bottom: 1rem;}
    .status-group label {margin-right: 1.5rem;font-weight: 700;cursor: pointer;color: #ea3b91;}
    .status-group input[type="radio"] {margin-right: 0.3rem;accent-color: #ea3b91;cursor: pointer;}
    .modal-footer {display: flex;justify-content: flex-end;gap: 1rem;}
    .btn-cancel {background: #dbdbdb;border: none;padding: 0.6rem 1.5rem;border-radius: 8px;font-weight: 700;cursor: pointer;color: #595959;transition: background-color 0.3s ease;}
    .btn-cancel:hover {background: #c4c4c4;}
    .btn-submit {background: linear-gradient(90deg, #ea3b91 0%, #fec74f 100%);border: none;padding: 0.6rem 1.8rem;border-radius: 8px;font-weight: 700;cursor: pointer;color: white;transition: background 0.3s ease;}
    .btn-submit:hover {background: linear-gradient(90deg, #f4b744 0%, #f645b1 100%);}
    /* Template table */
    .template-table {width: 100%;border-collapse: collapse;background:#fffafb;border-radius:12px;overflow: hidden;}
    .template-table thead tr {background:#fde1f2;}
    .template-table th, .template-table td {padding:1rem;text-align:left;font-size:1.07em;border-bottom: 2px solid #fcc2f2;color: #d23481;}
    .template-table tbody tr:last-child td {border-bottom: none;}
    .template-table td {vertical-align: middle;}
    .template-table th {color:#e10994;font-weight: bold;}
    /* Action icons styles */
    td button {background:none;border:none;cursor:pointer;color:#d23481;font-size:1.2rem;margin-right: 8px;padding: 0;line-height: 1;}
    td button:last-child {margin-right: 0;}
    td button:hover {color: #ea5a9f;}
    /* Modal Overlay & container */
    .modal-overlay {position: fixed;top: 0; left: 0; right: 0; bottom: 0;background: rgba(128,128,128,0.6);display: flex;justify-content: center;align-items: center;z-index: 1000;overflow-y: auto;padding: 1rem;}
    .modal {background: #fff;border-radius: 12px;max-height: 90vh;overflow-y: auto;padding: 2rem;box-shadow: 0 8px 25px rgba(210,52,129,0.25);font-family: 'Poppins', sans-serif;box-sizing: border-box;position: relative;width: 480px;}
    /* Modal titles */
    h2.modal-title {font-family: 'Fredoka One', cursive;font-weight: 900;font-size: 28px;margin: 0 0 1rem 0;color: #8BC34A; }
    #editModal #editModalTitle {color: #8BC34A;}
    /* Delete modal  */
    #deleteModal h2.modal-title {color: #d32f2f;font-size: 24px;display: flex;align-items: center;gap: 0.5rem;}
    #deleteModal .icon-warning {font-size: 30px;color: #d32f2f;}
    #deleteModal p {font-size: 1rem;margin: 0.25rem 0 0.5rem 0;color: black;}
    #deleteModal p.warning-text {color: #d32f2f;font-weight: 600;margin-bottom: 1.5rem;}
    /* View modal */
    .view-modal-overlay {position: fixed; inset: 0; background: rgba(0,0,0,0.45); display: none; justify-content: center; align-items: center; z-index: 1100; padding: 1rem;}
    .view-modal { background: linear-gradient(180deg,#fffafc 0%, #fff 100%); border-radius: 12px; inline-size: 760px; max-inline-size: calc(100% - 2rem); box-shadow: 0 10px 30px rgba(0,0,0,0.15); padding: 1.25rem 1.5rem; box-sizing: border-box; position: relative; }
    .view-modal .title { font-family: 'Fredoka One', cursive; font-size: 34px; color: #ea3b91; margin: 0 0 0.6rem 0; }
    .view-avatar { position: absolute; top: 18px; right: 22px; display:flex; align-items:center; gap:0.35rem; }
    .avatar-circle { width:56px; height:56px; border-radius:50%; background: #fff; border: 4px solid #fff; box-shadow: 0 2px 6px rgba(0,0,0,0.08); display:flex; align-items:center; justify-content:center; overflow:hidden; }
    .avatar-circle img { width:100%; height:100%; object-fit:cover; display:block; }
    .avatar-dot { width:12px; height:12px; background:#e94b4b; border-radius:50%; transform: translate(-14px,-34px); box-shadow:0 0 0 3px rgba(255,255,255,0.85); }
    .view-modal .view-grid { display: flex; gap: 1.2rem; }
    .view-left { flex: 1 1 440px; }
    .view-right { flex: 0 0 320px; border-left: 1px dashed #f4c1d9; padding-inline-start: 1rem; text-align: left; }
    .status-label { display:block; color:#d23481; font-weight:700; margin-bottom:0.35rem; }
    .status-badge { display:inline-block; background:#f9dceb; color:#ea3b91; font-weight:700; padding:0.6rem 1rem; border-radius: 12px; margin-bottom: 1rem; }
    .view-field { margin-block-end: 0.8rem; }
    .view-field input { inline-size: 100%; padding: 0.7rem 0.9rem; border-radius: 12px; border: none; background: #fff6f9; color: #333; box-sizing: border-box; font-weight:600; }
    .view-label { font-weight:700; color:#d23481; margin-block-end:0.35rem; display:block; }
    .asset-title { font-weight:800; font-size:1.05rem; color:#333; margin-block-end:0.6rem; }
    .asset-config { margin-block-end: 0.8rem; }
    .asset-preview img { inline-size: 100%; block-size: auto; border-radius:8px; border:1px solid #e6d7df; display:block; }
    .view-modal .modal-actions { display:flex; justify-content:flex-end; gap:0.8rem; margin-block-start:1rem; }
    .btn-close { background:#efefef; border: none; padding:0.6rem 1rem; border-radius:8px; font-weight:700; cursor:pointer; }
    .btn-close {padding: 0.6rem 1.2rem;font-weight: 700;border-radius: 8px;border: 2px solid #ddd;background-color: #f0f0f0;color: #666;cursor: pointer;transition: background-color 0.3s ease;}
    .btn-close:hover {background-color: #dcdcdc;}
    .btn-gotoedit  {background: linear-gradient(90deg, #f645b1  0%, #f4b744 100%);   border:none; padding:0.6rem 1rem; border-radius:8px; color:#fff; font-weight:700; cursor:pointer; }
    .btn-gotoedit:hover {background: linear-gradient(90deg, #f4b744 0%, #f645b1 100%); }
    /* Form labels and inputs */
    label {font-weight: 600;color: #4CAF50;display: block;margin-bottom: 0.2rem;font-size: 0.9rem;}
    input[type=text], select {width: 100%;padding: 0.5rem 0.8rem;font-size: 1rem;border: 1.5px solid #bdbdbd;border-radius: 8px;margin-bottom: 1rem;color: #333;font-weight: 500;box-sizing: border-box;}
    input[readonly] {background-color: #f9f9f9;border-color: #ddd;color: #999;font-weight: 600;cursor: not-allowed;}
    td button img {width: 16px;height: 16px;display: block;pointer-events: none; user-select: none;}
    td .action-icon {margin-right: 12px;}
    td .action-icon:last-child {margin-right: 0;}
    .modal-footer {display: flex;justify-content: flex-end;gap: 1rem;margin-top: 1rem;}
    button.btn-cancel {padding: 0.6rem 1.2rem;font-weight: 700;border-radius: 8px;border: 2px solid #ddd;background-color: #f0f0f0;color: #666;cursor: pointer;transition: background-color 0.3s ease;}
    button.btn-cancel:hover {background-color: #dcdcdc;}
    button.btn-confirm-delete {background: linear-gradient(90deg,#d32f2f 0%,#f57c00 100%);border: none;padding: 0.6rem 1.2rem;font-weight: 700;border-radius: 8px;color: white;cursor: pointer;transition: filter 0.3s ease;}
    button.btn-confirm-delete:hover { background: linear-gradient(90deg, #f57c00  0%,#d32f2f  100%);}
    button.btn-save {background: linear-gradient(90deg, #4caf50 0%, #cddc39 100%);border: none;padding: 0.6rem 1.4rem;font-weight: 700;border-radius: 8px;color: white;cursor: pointer;transition: filter 0.3s ease;}
    button.btn-save:hover { background: linear-gradient(90deg, #cddc39 0%,#4caf50  100%);}
    /* Edit modal layout */
    .edit-content {display: flex; gap: 0.6rem; flex-wrap: wrap;}
    .edit-left {flex: 1 1 200px;}
    .edit-right {flex: 1 1 220px; border-left: 1px solid #e0e0e0; padding-left: 0.6rem; text-align: center;}
    .preview-title {font-weight: 700; margin-bottom: 0.4rem; color: #4caf50; font-size: 0.95rem;}
    .preview-img {width: 100%; height: auto; border-radius: 8px; border: 1px solid #bdbdbd; margin-bottom: 0.6rem; max-height: 140px; object-fit: contain;}
    /* Compact edit modal specific rules */
    #editModal .modal { width: 720px; max-height: none; overflow-y: visible; padding: 1rem 1.25rem; }
    #editModal .modal .modal-footer { margin-top: 1rem; }
    .file-upload-label {background: linear-gradient(90deg, #4caf50 0%, #cddc39 100%);color: white;padding: 0.5rem 1rem;border-radius: 12px;font-weight: 700;font-size: 0.9rem;cursor: pointer;user-select: none;display: inline-block;transition: filter 0.3s ease;margin-bottom: 0.5rem;}
    .file-upload-label:hover {background: linear-gradient(90deg, #cddc39 0%,#4caf50  100%);}
    #editModal .upload-label {background:transparent;pointer-events: none; color: green;}
    #editModal .dual-upload-item {cursor: pointer;}
    #editModal .dual-upload-item input[type="file"] {display: none;width: 0;height: 0;}
    .file-status {color: #999;font-size: 0.85rem;font-weight: 500;margin-top: 0.3rem;pointer-events: none;}
    .file-upload-label:hover {filter: brightness(1.1);}
    input[type="file"] {display: none;}
    .usage-count {margin-bottom: 1rem;font-weight: 600;font-size: 0.9rem;color: #555;}
    @media (max-width: 650px) {
    .edit-content {flex-direction: column;}
    .edit-right {border-left: none;padding-left: 0;}}
    /* User Management Panel */
    .user { display: flex; gap:1rem; margin:2rem 0 0.8rem 0; align-items: center; }
    .user-controls { display: flex; gap:1rem; align-items: center; width: 100%; }
    .big-search { flex: 1 1 520px; padding: 0.95rem 1rem; font-size:1.05rem; border-radius: 12px; border: 1.5px solid #f0b9d6; background: #fff; color: #333; box-shadow: inset 0 1px 0 rgba(0,0,0,0.02); }
    .big-search::placeholder { color:#f0afcf; }
    .user-search-input { flex: none; padding:0.85rem 1rem; font-size:1.02em; border-radius:9px; border:1.7px solid #e10994; outline:none; background:#fff; }
    .user-select {padding:0.78rem 1rem; border-radius:9px; border:1.7px solid #e10994; background:#fff; font-size:1.02em; outline:none; min-width:160px;}
    .user-table {width: 100%;border-collapse: collapse;background:#fffafb;border-radius:12px;overflow: hidden;}
    .user-table thead tr {background:#fde1f2;}
    .user-table th, .user-table td {padding:1rem;text-align:left;font-size:1.07em;border-bottom: 2px solid #fcc2f2;color: #d23481;}
    .user-table tbody tr:last-child td {border-bottom: none;}
    .user-table td {vertical-align: middle;}
    .user-table th {color:#e10994;font-weight: bold;}
    .manage-link {color:#fa49c5; font-weight:700; cursor:pointer; text-decoration:none; font-size:1.11em; transition:text-decoration .2s;}
    .manage-link:hover {text-decoration:underline;}
    .tab-panel { animation: fadeIn .6s;}
    .deleteUserBtn{background: linear-gradient(90deg, #d32f2f 0%, #f57c00 100%); border: none; padding: 0.6rem 1.2rem; border-radius: 8px; color: white; font-weight: 700; cursor: pointer; width: 100%;}
    .deleteUserBtn:hover { background: linear-gradient(90deg, #f57c00 0%, #d32f2f 100%);}
    .saveChangeBtn{background: linear-gradient(90deg, #4caf50 0%, #cddc39 100%); border: none; padding: 0.6rem 1rem; border-radius: 8px; color: white; font-weight: 700; cursor: pointer; margin-right: 0.5rem;}
    .saveChangeBtn:hover { background: linear-gradient(90deg, #cddc39 0%, #4caf50 100%);}
    .closeManageBtn{background: #efefef; border: none; padding: 0.6rem 1rem; border-radius: 8px; font-weight: 700; cursor: pointer;}
    .closeManageBtn:hover {background-color: #dcdcdc;}
    /* UPDATED FAVORITES SECTION */
    #section-favorites {user-select: none;display: none;}
    #section-favorites.active { display: block;}
    #section-favorites h2 {font-family: 'Fredoka One', cursive;font-size: 30px;margin-top: 0;color: #c32d6c;}
    .favorites-vertical-container {display: flex;gap: 40px;user-select: none;flex-wrap: wrap;padding-top: 30px;}
    .no-favorites-msg {font-style: italic;color: #f9acdb;user-select: none;text-align: center;padding: 20px;width: 100%;grid-column: 1 / -1;}
    .vertical-template-card.dragging {opacity: 0.5;transform: scale(0.95);box-shadow: 0 8px 25px rgba(210, 52, 129, 0.5);}
    .favorites-vertical-container.drop-zone {border: 2px dashed #ea5a9f;border-radius: 16px;min-height: 200px;display: flex;align-items: center;justify-content: center;background-color: rgba(234, 90, 159, 0.05);transition: all 0.3s ease;}
    .favorites-vertical-container.drop-zone.active {background-color: rgba(234, 90, 159, 0.1);border-color: #d23481;}
    .drop-message {color: #d23481;font-weight: 600;font-size: 1.2rem;text-align: center;padding: 20px;}
    /* Activity Section */
    #section-activity { user-select: none; display: none; }
    #section-activity.active { display: block; }
    #section-activity h2 { font-family: 'Fredoka One', cursive; font-size: 30px; margin-top: 0; color: #c32d6c; }
    .activity-container { display: flex; flex-direction: column; gap: 22px; height: 100%; overflow-y: auto; }
    .activity-post { background: white; border-radius: 14px; border: 1px solid #f3c7d9; padding: 12px 14px; font-size: 14px; line-height: 1.3; color: #d72b7e; white-space: pre-line; word-break: break-word; }
    .activity-post.empty { font-style: italic; color: #f29dcc; border-color: #fddaeb; }
    /* FEED SECTION STYLES */
    #section-feed {user-select: none;display: none;}
    #section-feed.active {display: block;}
    #section-feed h2 {font-family: 'Fredoka One', cursive;font-size: 30px;margin-top: 0;color: #c32d6c;}
    .tabnav {display: flex;gap: 2rem;border-bottom: 2px solid #ea5a9f;margin-bottom: 1.2rem;user-select: none;}
    .tabnav button {background: none;border: none;cursor: pointer;font-weight: 600;font-size: 1rem;color: #d23481;border-bottom: 3px solid transparent;padding-bottom: 0.4rem;transition: color 0.3s, border-color 0.3s;}
    .tabnav button:hover {color: #ea5a9f;}
    .tabnav button.active {border-color: #ea5a9f;font-weight: 700;color: #ea5a9f;}
    .vertical-templates-container {display: flex;gap: 40px;user-select: none;flex-wrap: wrap;}
    .vertical-template-card {position: relative;width: 200px;height: 500px; padding: 16px;border-radius: 16px;background: linear-gradient(to bottom, #5e2e55, #765075);box-shadow: 0 1px 28px 10px rgb(169 42 89 / 0.2);display: flex;flex-direction: column;justify-content: flex-start;user-select: none;overflow: hidden;background-size: cover;background-position: center;transition: all 0.3s ease;}
    .template-photo-container {width: 100%;height: 380px; /* Increased height for bigger photos */position: relative;overflow: hidden;border-radius: 6px;background-color: rgba(255, 255, 255, 0.9);box-shadow: inset 0 0 3px #0070c0;}
    .template-photo-single {width: 100%;height: 100%;background-size: cover;background-position: center;position: relative;}
    .template-photo-multiple {display: grid;width: 100%;height: 100%;position: relative;}
    .template-photo-multiple.two-shots {grid-template-columns: 1fr 1fr;gap: 4px;}
    .template-photo-multiple.three-shots {grid-template-columns: 1fr 1fr;grid-template-rows: 1fr 1fr;gap: 4px;}
    .template-photo-multiple.four-shots {grid-template-columns: 1fr 1fr;grid-template-rows: 1fr 1fr;gap: 4px;}
    .photo-slot {background-size: cover;background-position: center;border-radius: 4px;}
    .sticker-overlay {position: absolute;top: 0;left: 0;width: 100%;height: 100%;pointer-events: none;z-index: 2;}
    .sticker {position: absolute;width: 40px;height: 40px;background-size: contain;background-repeat: no-repeat;background-position: center;cursor: grab;transition: transform 0.2s ease, box-shadow 0.2s ease;z-index: 3;}
    .sticker.dragging {cursor: grabbing;box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);transform: scale(1.1);z-index: 10;}
    .sticker:hover {transform: scale(1.05);}
    .template-tags {margin-top: 8px;font-size: 0.75rem;padding: 20px;color: #f4cade;text-align: center;max-height: 40px;overflow: hidden;text-overflow: ellipsis;display: -webkit-box;line-clamp: 2;}
    .vertical-template-icons {position: absolute;top: 16px;right: 16px;display: flex;flex-direction: column;gap: 14px;user-select: none;opacity: 0;transition: opacity 0.3s ease;z-index: 5;}
    .vertical-template-card:hover .vertical-template-icons {opacity: 1;}
    .vertical-template-icons button {background: none;border: none;cursor: pointer;padding: 0;display: flex;justify-content: center;align-items: center;transition: transform 0.2s;}
    .vertical-template-icons button:hover {transform: scale(1.1);}
    .vertical-template-icons img {width: 24px;height: 24px;pointer-events: none;user-select: none;}
    .vertical-use-template-btn {background-color: #db2d73;border: none;border-radius: 8px;color: white;font-weight: 700;font-size: 1rem;padding: 0.75rem 1.25rem;cursor: pointer;display: flex;align-items: center;gap: 8px;user-select: none;box-shadow: 0 4px 10px rgb(219 45 115 / 0.7);transition: background-color 0.3s ease;user-select: none;opacity: 0;transition: opacity 0.3s ease;z-index: 3;position: relative;}
    .vertical-template-card:hover .vertical-use-template-btn {opacity: 1;}
    .vertical-use-template-btn img {width: 20px;height: 20px;filter: invert(100%);user-select: none;pointer-events: none;}
    .vertical-use-template-btn:hover,
    .vertical-use-template-btn:focus {background-color: #a31a62;outline: none;}
    /* Upload your template card */
    .template-upload-card {width: 200px; height: 500px; border: 2.4px solid #f4cade;border-radius: 16px;display: flex;flex-direction: column;justify-content: center;align-items: center;cursor: pointer;font-weight: 700;font-size: 1.35rem;color: #f4cade;transition: background-color 0.3s ease;user-select: none;}
    .template-upload-card > .plus-sign {font-size: 5rem;line-height: 1;margin-bottom: 8px;user-select: none;}
    .template-upload-card:hover,
    .template-upload-card:focus {background-color: #fce9f1;outline: none;}
    /* File upload input */
    #template-upload-input {display: none;}
    /* Favorite button active state */
    .favorite-active {filter: invert(23%) sepia(95%) saturate(2106%) hue-rotate(320deg) brightness(90%) contrast(101%);}
    .frame-2x6 {width: 100%;height: 380px;}
    .frame-4x6 {width: 100%;height: 450px;}
    /* Effect filters */
    .effect-none {filter: none;}
    .effect-bw {filter: grayscale(100%);}
    .effect-warm {filter: sepia(0.3) saturate(1.2) hue-rotate(-10deg);}
    .effect-cool {filter: sepia(0.2) saturate(0.8) hue-rotate(180deg) brightness(1.1);}
    .effect-retro {filter: sepia(0.5) contrast(1.2) saturate(1.3);}
    .effect-noir {filter: grayscale(100%) contrast(1.5) brightness(0.8);}
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(15px);}
      to { opacity: 1; transform: translateY(0);}
    }
    @media (max-width:900px) {
      .template-management-actions {flex-direction:column;gap:1rem;}
      .upload-btn {width:100%;height:95px;}
      .template-search {width:100%;}
      .stats, .charts { flex-direction:column;}
      .user-management-search-row {flex-direction:column;gap:1rem;}
      .left-buttons span { display:none;}
      .sidebar { width:60px;}
      .main-content, .subnav { flex-direction:column; align-items:flex-start; gap:0.5rem;}
      .template-grid {grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));}
    }
  </style>
</head>
<body>
  <div class="container">
    <nav class="sidebar" aria-label="Sidebar Navigation">
      <div class="logo">
        <img src="Icons/11.svg" alt="Webooth logo" />
      </div>
      <div class="left-buttons">
        <button data-target="feed" aria-label="Feed" class="active">
          <img src="Icons 2/templates.svg" alt="Feed icon" />
          <span>Feed</span>
        </button>
        <button data-target="favorites" aria-label="Favorites">
          <img src="Icons 2/favorites.svg" alt="Favorites icon" />
          <span>Favorites</span>
        </button>
        <button data-target="activity" aria-label="Activity">
          <img src="Icons 2/activity.svg" alt="Activity icon" />
          <span>Activity</span>
        </button>
        <button data-target="logout" aria-label="Logout">
          <img src="Icons 2/logout.svg" alt="Logout icon" />
          <span>Logout</span>
        </button>
      </div>
    </nav>
    <main class="main-content" role="main">
      <header class="topbar">
        <h1>Admin Dashboard</h1>
        <div class="right-buttons">
          <button onclick="window.location.href='booth.html'">
            <img src="Icons/2.svg" alt="Booth icon" />
            Booth
          </button>
          <button onclick="window.location.href='finalprof.html'">
            <img src="Icons/4.svg" alt="Profile icon" />
            Profile
          </button>
          <button onclick="window.location.href='admin.html'">
            <img src="Icons/3.svg" alt="Admin icon" />
            Admin
          </button>
        </div>
      </header>
      <div class="subnav" role="tablist" aria-label="Main Content Tabs">
        <button role="tab" aria-selected="true" class="active" onclick="showTab(0)">Usage Stats</button>
        <button role="tab" aria-selected="false" onclick="showTab(1)">Template Management</button>
        <button role="tab" aria-selected="false" onclick="showTab(2)">User Management</button>
        <button role="tab" aria-selected="false" onclick="showTab(3)">Audit Trail</button>
      </div>
      <div id="tab-panels">
        <section class="tab-panel" style="display:block;">
          <section class="stats">
            <div class="stat-card">
              <h3>Total Users</h3>
              <p class="number" id="total-users">0</p>
              <p class="growth" id="user-growth">
                <i class="percentage"></i> 0% this week
              </p>
            </div>
            <div class="stat-card">
              <h3>Photos Captured</h3>
              <p class="number" id="photos-captured">0</p>
              <p class="growth" id="photo-growth">
                <i class="percentage"></i> 0% this week
              </p>
            </div>
          </section>
          <section class="charts">
            <div class="chart-card">
              <h3>User Growth</h3>
              <div class="chart-placeholder" id="user-growth-chart">[Line Chart Placeholder]</div>
            </div>
            <div class="chart-card">
              <h3>Photo Volume</h3>
              <div class="chart-placeholder" id="photo-volume-chart">[Bar Chart Placeholder]</div>
            </div>
          </section>
        </section>
        <section class="tab-panel" style="display:none;">
          <div class="template">
            <button class="upload-btn" onclick="openModal()">
              +<br>Upload New Template/Pack
            </button>
            <form class="template-search" onsubmit="event.preventDefault();">
              <div class="template-search-row-top">
                <input type="text" id="templateSearch" placeholder="Search Template Name..." />
              </div>
              <div class="template-search-row-bottom">
                <label for="typeFilter">Type</label>
                <select id="typeFilter">
                  <option>All</option>
                  <option>Sticker Pack</option>
                  <option>Background</option>
                  <option>Filter</option>
                </select>
                <label for="statusFilter">Status</label>
                <select id="statusFilter">
                  <option>Active</option>
                  <option>Needs Review</option>
                  <option>Draft</option>
                </select>
                <label for="dateFilter">Date</label>
                <input type="date" id="dateFilter" value="clear"/>
              </div>
            </form>
          </div>
          <table class="template-table">
            <thead>
              <tr>
                <th>Name</th>
                <th>Type</th>
                <th>Usage Count</th>
                <th>Status</th>
                <th>Date Added</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="templateTableBody">
              <tr>
                <td>Warm Filter</td>
                <td>Filter</td>
                <td>159</td>
                <td>Active</td>
                <td>2025-11-10</td>
                <td style="white-space: nowrap;">
                  <button aria-label="View" title="View" onclick="openViewModal(exampleFilterTemplate)" >
                    <img src="Icons 3/view.svg" alt="View logo" />
                  </button>
                  <button aria-label="Edit" title="Edit" onclick="openEditModal(exampleFilterTemplate)" >
                    <img src="Icons 2/edit.svg" alt="View logo" />
                  </button>
                  <button aria-label="Delete" title="Delete" onclick="openDeleteModal('Warm Filter')" >
                    <img src="Icons 3/delete.svg" alt="Delete logo" />
                  </button>
                </td>
              </tr>
              <tr>
                  <td>Sunset Background</td>
                  <td>Background</td>
                  <td>42</td>
                  <td>Active</td>
                  <td>2025-11-12</td>
                  <td style="white-space: nowrap;">
                    <button aria-label="View" title="View" onclick="openViewModal(exampleBackgroundTemplate)">
                      <img src="Icons 3/view.svg" alt="View logo" />
                    </button>
                    <button aria-label="Edit" title="Edit" onclick="openEditModal(exampleBackgroundTemplate)">
                      <img src="Icons 2/edit.svg" alt="Edit logo" />
                    </button>
                    <button aria-label="Delete" title="Delete" onclick="openDeleteModal('Sunset Background')">
                      <img src="Icons 3/delete.svg" alt="Delete logo" />
                    </button>
                  </td>
                </tr>
            </tbody>
          </table>
        </section>
        <section class="tab-panel" style="display:none;">
          <div class="user">
            <div class="user-controls">
              <input 
              type="text" 
              id="userSearchInput" 
              class="user-select1" 
              style="border: 2px solid #e10994;; height: 48px; padding: 10px;" 
              placeholder="Search Username or Email..." 
              />
              <select id="userGroupFilter" class="user-select">
                <option>All groups</option>
                <option>User</option>
                <option>Admin</option>
              </select>
              <select id="userStatusFilter" class="user-select">
                <option>Status</option>
                <option>Active</option>
                <option>Inactive</option>
              </select>
            </div>
          </div>
          <table class="user-table">
            <thead>
              <tr>
                <th>Username</th>
                <th>Email</th>
                <th>Role</th>
                <th>Status</th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>kath</td>
                <td>kath@example.com</td>
                <td>Admin</td>
                <td>Active</td>
                <td><a class="manage-link" href="#">Manage</a></td>
              </tr>
              <tr>
                <td>JaneSmith</td>
                <td>jane@example.com</td>
                <td>User</td>
                <td>Inactive</td>
                <td><a class="manage-link" href="#">Manage</a></td>
              </tr>
            </tbody>
          </table>
        </section>
        <section class="tab-panel" style="display:none;">
          <div class="user">
            <div class="user-controls">
              <input 
              type="text" 
              id="userSearchInput" 
              class="user-select1" 
              style="border: 2px solid #d23481;; height: 50px; padding: 10px;" 
              placeholder="Search Username or Email..." 
              />
              <select id="userGroupFilter" class="user-select">
                <option>User Type</option>
                <option>System</option>
                <option>Regular User</option>
                <option>Admin</option>
              </select>
              <select id="userStatusFilter" class="user-select">
                <option>Action Type</option>
                <option>Login</option>
                <option>Deletion</option>
                <option>Content Upload</option>
                <option>Configuration Change</option>
                <option>System Error</option>
              </select>
            </div>
          </div>
          <table class="user-table">
            <thead>
              <tr>
                <th>Timestamp</th>
                <th>User</th>
                <th>Action</th>
                <th>IP Address</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>2025-11-15 10:23:45</td>
                <td>admin_user</td>
                <td>Deleted template "Old Filter"</td>
                <td>192.168.1.1</td>
              </tr>
            </tbody>
          </table>
        </section>
      </div>
      <section id="section-feed" class="section" role="region" aria-label="Feed Section" style="display:none;">
        <h2>Feed</h2>
        <nav class="tabnav" role="tablist" aria-label="Templates Tabs">
          <button role="tab" aria-selected="true" class="active" id="tab-shared-btn">Shared to Community</button>
          <button role="tab" aria-selected="false" id="tab-mytemplates-btn">My Templates</button>
        </nav>
        <section id="tab-shared" role="tabpanel" aria-labelledby="tab-shared-btn" style="display:block;">
          <div class="vertical-templates-container" aria-live="polite" aria-label="Shared templates grid">
            </div>
        </section>
        <section id="tab-mytemplates" role="tabpanel" aria-labelledby="tab-mytemplates-btn" style="display:none;">
          <div class="vertical-templates-container" aria-live="polite" aria-label="My templates grid">
            <div class="template-upload-card" tabindex="0" role="button" aria-label="Upload your template" 
              id="open-upload-modal-btn"
              onkeydown="if(event.key==='Enter'||event.key===' ') { event.preventDefault(); alert('Upload template modal would open here'); }">
              <div class="plus-sign">+</div>
              Upload your template
            </div>
          </div>
        </section>
      </section>
      <section id="section-favorites" class="section" role="region" aria-label="Favorites Section" style="display:none;">
        <h2>Favorites</h2>
        <div class="favorites-vertical-container" id="favoritesContainer" aria-live="polite">
          </div>
      </section>
      <section id="section-activity" class="section" role="region" aria-label="Activity Log Section" style="display:none;">
        <h2>Activity</h2>
        <div class="activity-container" aria-live="polite"></div>
      </section>
    </main>
  </div>
  <div class="modal-overlay" id="uploadModal" role="dialog" aria-modal="true" aria-labelledby="modalTitle" style="display:none;">
    <div class="modal">
      <h2 id="modalTitle">Upload New Template</h2>
      <form id="uploadForm" onsubmit="event.preventDefault(); submitForm();">
        <label for="templateName">Template Name</label>
        <input type="text" id="templateName" name="templateName" placeholder="e.g., Soft Blur Filter" required />

        <div class="upload-form-row">
          <div class="form-group">
            <label for="templateType">Template Type</label>
            <select id="templateType" name="templateType" required onchange="updateUploadFields()">
              <option value="Filter">Filter</option>
              <option value="Background">Background</option>
              <option value="Sticker Pack">Sticker Pack</option>
            </select>
          </div>
          <div class="form-group">
            <label for="tags">Tags</label>
            <input type="text" id="tags" name="tags" placeholder="e.g., soft, blur, light" />
          </div>
        </div>
        <div id="dualUploadContainer" style="display:none;">
          <p class="upload-instruction">Dual Size Assets (Requires 2x6 and 4x6 PNGs)</p>
          <div class="dual-upload-group">
            <div class="dual-upload-item">
              <span>1. 2x6 Inch Asset (.PNG)</span>
              <label class="upload-label" for="upload2x6">Upload 2x6 File</label>
              <input type="file" id="upload2x6" name="upload2x6" accept=".png" required />
            </div>
            <div class="dual-upload-item">
              <span>2. 4x6 Inch Asset (.PNG)</span>
              <label class="upload-label" for="upload4x6">Upload 4x6 File</label>
              <input type="file" id="upload4x6" name="upload4x6" accept=".png" required />
            </div>
          </div>
        </div>
        <div id="singleUploadContainer">
          <p class="upload-instruction" id="uploadInstruction">Upload Asset File (Filter Config or Single PNG)</p>
          <div class="single-upload-box">
            <label class="upload-label" for="singleUpload">Browse Files</label>
            <input type="file" id="singleUpload" name="singleUpload" accept=".png,.json" required />
          </div>
        </div>
        <div class="status-group">
          <label>Initial Status</label>
          <label><input type="radio" name="status" value="Draft" checked /> Draft</label>
          <label><input type="radio" name="status" value="Active" /> Active</label>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn-cancel" onclick="closeModal()">Cancel</button>
          <button type="submit" class="btn-submit">Upload & Submit</button>
        </div>
      </form>
    </div>
  </div>
  <div class="modal-overlay" id="deleteModal" style="display:none;" role="dialog" aria-modal="true" aria-labelledby="deleteModalTitle">
    <div class="modal">
      <h2 class="modal-title" id="deleteModalTitle">
        <i class="fas fa-exclamation-triangle icon-warning" aria-hidden="true"></i>
        Confirm Deletion
      </h2>
      <p id="deleteMessage">Are you sure you want to permanently delete this template?</p>
      <p class="warning-text">This action cannot be undone and will be logged in the Audit Trail.</p>
      <div class="modal-footer">
        <button class="btn-cancel" onclick="closeDeleteModal()">Cancel</button>
        <button class="btn-confirm-delete" onclick="confirmDelete()">Confirm Deletion</button>
      </div>
    </div>
  </div>
    <div class="view-modal-overlay" id="viewModal" role="dialog" aria-modal="true" aria-labelledby="viewModalTitle">
      <div class="view-modal" role="document">
        <div class="title" id="viewModalTitle">Template Details</div>
        <div class="view-grid">
          <div class="view-left">
            <label class="status-label">Template Status</label>
            <div class="status-badge" id="viewStatus">Active</div>
            <div class="view-field">
              <label class="view-label">Template Name</label>
              <input type="text" id="viewTemplateName" readonly />
            </div>
            <div class="view-field">
              <label class="view-label">Tags</label>
              <input type="text" id="viewTags" readonly />
            </div>
            <div style="display:flex; gap:0.8rem;">
              <div style="flex:1;">
                <label class="view-label">Type</label>
                <input type="text" id="viewType" readonly />
              </div>
              <div style="width:120px;">
                <label class="view-label">Usage Count</label>
                <input type="text" id="viewUsageCount" readonly />
              </div>
            </div>
            <div class="view-field" style="margin-top:0.6rem;">
              <label class="view-label">Uploader / Date Added</label>
              <input type="text" id="viewUploader" readonly />
            </div>
          </div>
          <div class="view-right">
            <div class="asset-title">Asset Files</div>
            <div class="asset-config" id="viewConfigContainer">
              <label class="view-label">Configuration File:</label>
              <input type="text" id="viewConfigFile" readonly />
            </div>
            <div id="viewDualAssets" style="display:none;">
              <div style="margin-block-end:0.6rem;font-weight:700;color:#d23481;">Dual Assets:</div>
              <div class="view-field">
                <label class="view-label">2x6 Inch File:</label>
                <input type="text" id="view2x6FileName" readonly />
              </div>
              <div class="view-field">
                <label class="view-label">4x6 Inch File:</label>
                <input type="text" id="view4x6FileName" readonly />
              </div>
              <div style="display:flex; gap:0.6rem; margin-top:0.6rem;">
                <div style="flex:1; max-inline-size:100px;">
                  <div class="asset-preview" id="viewAssetPreview2x6"></div>
                </div>
                <div style="flex:1; max-inline-size:100px;">
                  <div class="asset-preview" id="viewAssetPreview4x6"></div>
                </div>
              </div>
            </div>
            <div class="asset-preview" id="viewAssetPreview"></div>
          </div>
        </div>
        <div class="modal-actions">
          <button class="btn-close" onclick="closeViewModal()">Close</button>
          <button class="btn-gotoedit" onclick="openEditModal(exampleFilterTemplate)">Go to Edit</button>
        </div>
      </div>
    </div>
    <div class="modal-overlay" id="editModal" style="display:none;" role="dialog" aria-modal="true" aria-labelledby="editModalTitle">
    <div class="modal">
      <h2 class="modal-title" id="editModalTitle">Edit Template</h2>
      <form id="editForm" onsubmit="event.preventDefault(); saveChanges();">
        <div class="edit-content">
          <div class="edit-left">
            <label for="editTemplateName">Template Name</label>
            <input type="text" id="editTemplateName" name="templateName" required />
            <label for="editTags">Tags</label>
            <input type="text" id="editTags" name="tags" />
            <label for="editType">Type</label>
            <select id="editType" name="type" required>
              <option value="Filter">Filter</option>
              <option value="Background">Background</option>
              <option value="Sticker Pack">Sticker Pack</option>
            </select>

            <div class="usage-count" id="editUsageCount">Usage Count: 0 times</div>

            <label for="editStatus">Template Status</label>
            <select id="editStatus" name="templateStatus" required>
              <option value="Active">Active</option>
              <option value="Draft">Draft</option>
              <option value="Needs Review">Needs Review</option>
            </select>
          </div>
          <div class="edit-right">
            <div class="preview-title">Current Asset Preview</div>
            <div id="assetPreviewContainer"></div>
            <div id="editFilterUploadContainer" style="margin-top: 1rem; display:none;">
              <label for="replaceFilterFile" class="file-upload-label" tabindex="0">Replace Main Asset File</label>
              <input type="file" id="replaceFilterFile" name="replaceFilterFile" accept=".png,.json" />
            </div>
            <div id="editDualUploadContainer" style="margin-top: 1rem; display:none;">
              <p class="upload-instruction">Replace Dual Size Assets</p>
              <div class="dual-upload-group">
                <div class="dual-upload-item" onclick="document.getElementById('editReplace2x6File').click();">
                  <label class="upload-label" for="editReplace2x6File">Upload New 2x6 File</label>
                  <div class="file-status">No file selected</div>
                  <input type="file" id="editReplace2x6File" name="editReplace2x6File" accept=".png" />
                </div>
                <div class="dual-upload-item" onclick="document.getElementById('editReplace4x6File').click();">
                  <label class="upload-label" for="editReplace4x6File">Upload New 4x6 File</label>
                  <div class="file-status">No file selected</div>
                  <input type="file" id="editReplace4x6File" name="editReplace4x6File" accept=".png" />
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer" style="margin-top: 1.5rem;">
          <button type="button" class="btn-cancel" onclick="closeEditModal()">Cancel</button>
          <button type="submit" class="btn-save">Save Changes</button>
        </div>
      </form>
    </div>
  </div>
  <div class="modal-overlay" id="manageUserModal" style="display:none;" role="dialog" aria-modal="true" aria-labelledby="manageUserTitle">
    <div class="modal" style="width: 700px; max-height: 100vh; overflow-y: auto;">
      <h2 id="manageUserTitle" style="font-family: 'Fredoka One', cursive; font-size: 28px; color: #ea3b91; margin: 0 0 1.5rem 0;">Manage User</h2>
      <div style="display: flex; border-bottom: 2px solid #f4c1d9; margin-bottom: 1.5rem;">
        <button id="accountDetailsTab" class="tab-button active" onclick="switchTab('accountDetails')" style="flex: 1; padding: 0.5rem; background: none; border: none; border-bottom: 3px solid #ea3b91; color: #ea3b91; font-weight: 700; cursor: pointer;">Account Details</button>
        <button id="activityContentsTab" class="tab-button" onclick="switchTab('activityContents')" style="flex: 1; padding: 0.5rem; background: none; border: none; border-bottom: 3px solid transparent; color: #d23481; font-weight: 700; cursor: pointer;">Activity & Contents</button>
      </div>
      <div id="accountDetailsContent" class="tab-content" style="display: block; overflow-y: auto;">
        <div style="display: flex; gap: 2rem;">
          <div style="flex: 1;">
            <div style="display: flex; flex-direction: column; gap: 1rem;">
              <div>
                <label style="font-weight: 600; color: #ea3b91; display: block; margin-bottom: 0.3rem;">Username</label>
                <input type="text" id="manageUsername" readonly style="width: 100%; padding: 0.5rem; border: 1px solid #f4c1d9; border-radius: 8px; background: #fff6f9; color: #333;" />
              </div>
              <div>
                <label style="font-weight: 600; color: #ea3b91; display: block; margin-bottom: 0.3rem;">User Email</label>
                <input type="text" id="manageEmail" readonly style="width: 100%; padding: 0.5rem; border: 1px solid #f4c1d9; border-radius: 8px; background: #fff6f9; color: #333;" />
              </div>
              <div>
                <label style="font-weight: 600; color: #ea3b91; display: block; margin-bottom: 0.3rem;">Joined</label>
                <input type="text" id="manageJoined" readonly style="width: 100%; padding: 0.5rem; border: 1px solid #f4c1d9; border-radius: 8px; background: #fff6f9; color: #333;" />
              </div>
              <div>
                <label style="font-weight: 600; color: #ea3b91; display: block; margin-bottom: 0.3rem;">Total Photos</label>
                <input type="text" id="manageTotalPhotos" readonly style="width: 100%; padding: 0.5rem; border: 1px solid #f4c1d9; border-radius: 8px; background: #fff6f9; color: #333;" />
              </div>
            </div>
          </div>
          <div style="flex: 1;">
            <div style="margin-bottom: 2rem;">
              <label style="font-weight: 600; color: #ea3b91; display: block; margin-bottom: 0.5rem;">Account Status</label>
              <select id="manageStatus" style="width: 100%; padding: 0.5rem; border: 1px solid #f4c1d9; border-radius: 8px; background: #fff; color: #333;">
                <option value="Active">Active</option>
                <option value="Inactive">Inactive</option>
              </select>
            </div>
            <div style="margin-bottom: 2rem;">
              <label style="font-weight: 600; color: #ea3b91; display: block; margin-bottom: 0.5rem;">User Role</label>
              <select id="manageRole" style="width: 100%; padding: 0.5rem; border: 1px solid #f4c1d9; border-radius: 8px; background: #fff; color: #333;">
                <option value="User">User</option>
                <option value="Admin">Admin</option>
              </select>
            </div>
            <button id="deleteUserBtn" class="deleteUserBtn">Delete User</button>
          </div>
        </div>
      </div>
      <div id="activityContentsContent" class="tab-content" style="display: none; overflow-y: auto; overflow-x: hidden;">
        <div style="display: flex; flex-direction: column; gap: 2rem;">
          <div>
            <h3 style="font-family: 'Fredoka One', cursive; font-size: 20px; color: #d23481; margin-bottom: 1rem;">Recent Activity Log</h3>
            <div style="padding: 1rem; border: 1px solid #f4c1d9; border-radius: 8px; background: #fff6f9; min-height: 200px;">
              <ul style="margin: 0; padding-left: 1rem; color: #d23481;">
                <li>Last login: 2023-10-01 at 14:30</li>
                <li>Uploaded 5 photos on 2023-09-15</li>
                <li>Changed profile picture on 2023-08-20</li>
                <li>Joined event "Summer Party" on 2023-07-10</li>
              </ul>
            </div>
          </div>
          <div>
            <h3 style="font-family: 'Fredoka One', cursive; font-size: 20px; color: #d23481; margin-bottom: 1rem;">Capture Photos</h3>
            <div style="display: flex; flex-direction: column; gap: 0.5rem;">
              <img src="https://placehold.co/150x100?text=Photo+1" alt="Captured Photo 1" style="width: 100%; border-radius: 8px; border: 1px solid #f4c1d9;" />
              <img src="https://placehold.co/150x100?text=Photo+2" alt="Captured Photo 2" style="width: 100%; border-radius: 8px; border: 1px solid #f4c1d9;" />
              <img src="https://placehold.co/150x100?text=Photo+3" alt="Captured Photo 3" style="width: 100%; border-radius: 8px; border: 1px solid #f4c1d9;" />
              <img src="https://placehold.co/150x100?text=Photo+4" alt="Captured Photo 4" style="width: 100%; border-radius: 8px; border: 1px solid #f4c1d9;" />
            </div>
          </div>
        </div>
      </div>
      <div style="display: flex; justify-content: flex-end; margin-top: 2rem;">
        <button onclick="saveChangesUser()" class="saveChangeBtn">Save Changes</button>
        <button onclick="closeManageUserModal()" class="closeManageBtn">Close</button>
      </div>
    </div>
  </div>
  <div class="modal-overlay" id="deleteUserModal" style="display:none;" role="dialog" aria-modal="true" aria-labelledby="deleteUserModalTitle">
    <div class="modal">
      <h2 class="modal-title" id="deleteUserModalTitle">
        <img src="icons 3/warn.svg" alt="Warning Icon" style="display: block; margin: 0 auto; width: 50px; height: 50px;" />
      </h2>
      <p style="font-size: 1rem; margin: 0.25rem 0 0.5rem 0; color: grey; text-align: center;">Are you sure you want to permanently delete this user?</p>
      <p class="warning-text" style="color: #d32f2f; font-weight: 600; margin-bottom: 1.5rem; text-align: center;">This action cannot be undone and will be logged in the audit trail.</p>
      <div class="modal-footer">
        <button class="btn-cancel" onclick="closeDeleteUserModal()">Cancel</button>
        <button class="btn-confirm-delete" onclick="confirmDeleteUser()">Complete Deletion</button>
      </div>
    </div>
  </div>

  <script>
    const sharedTemplates = [
      {
        id: 1,
        photos: [],
        favorite: false,
        name: 'Holiday Template',
        frameSize: '2x6',
        shots: '1',
        effect: 'warm',
        shareToCommunity: true,
        tags: '#holiday #fun'
      },
     
    ];

    const state = {
      user: {
        username: 'Username',
        bio: 'bio',
        photoCount: 0,
        profileImg: ''
      },
      photos: [
        {
          id: 1,
          src: '',
          liked: false,
          favorite: false,
          date: 'October 29',
          comments: []
        },
       
      ],
      activities: [],
      myTemplates: []
    };
    function copyFirstTemplateToMyTemplates() {
      if (sharedTemplates.length > 0 && state.myTemplates.length === 0) {
        const firstTemplate = sharedTemplates[0];
        const templateCopy = {
          ...firstTemplate,
          id: Date.now(), // Give it a new unique ID
          isCopied: true,
          originalTemplateId: firstTemplate.id
        };
        state.myTemplates.push(templateCopy);
        addActivity(`Template "${firstTemplate.name}" automatically added to My Templates`);
      }
    }
    // Function to create Shared Template card - VERTICAL DESIGN
    function createSharedTemplateCard(template) {
      const article = document.createElement('article');
      article.className = 'vertical-template-card';
      article.draggable = true;
      article.dataset.templateId = template.id;
      article.dataset.templateType = 'shared';
      // Set background image if available
      if (template.photos && template.photos.length > 0) {
        article.style.backgroundImage = `url('${template.photos[0]}')`;
      }
      article.setAttribute('aria-label', `Shared template: ${template.name}`);
      // Template photo container
      const photoContainer = document.createElement('div');
      photoContainer.className = 'template-photo-container';
      // Create photo layout based on shots
      const shots = parseInt(template.shots || 1);
      const frameSize = template.frameSize || '2x6';
      const effect = template.effect || 'none';
      
      if (shots === 1) {
        const photoDiv = document.createElement('div');
        photoDiv.className = `template-photo-single frame-${frameSize} effect-${effect}`;
        photoDiv.style.backgroundColor = 'rgba(255, 255, 255, 0.9)';
        
        photoContainer.appendChild(photoDiv);
      } else {
        const multipleContainer = document.createElement('div');
        multipleContainer.className = `template-photo-multiple ${shots}-shots frame-${frameSize}`;
        
        for (let i = 0; i < shots; i++) {
          const photoSlot = document.createElement('div');
          photoSlot.className = `photo-slot effect-${effect}`;
          photoSlot.style.backgroundColor = 'rgba(255, 255, 255, 0.9)';
          multipleContainer.appendChild(photoSlot);
        }
        photoContainer.appendChild(multipleContainer);
      }
      // Add stickers
      if (template.photos && template.photos.length > 1) {
        const stickerOverlay = document.createElement('div');
        stickerOverlay.className = 'sticker-overlay';
        // Use saved positions if available, otherwise use default positions
        const defaultPositions = [
          { top: '10%', left: '10%', rotate: '5deg' },
          { top: '15%', left: '80%', rotate: '-10deg' },
          { top: '50%', left: '20%', rotate: '15deg' },
          { top: '60%', left: '70%', rotate: '-5deg' },
          { top: '80%', left: '30%', rotate: '10deg' },
          { top: '85%', left: '85%', rotate: '-15deg' }
        ];
        
        template.photos.slice(1).forEach((sticker, index) => {
          const savedPosition = template.stickerPositions && template.stickerPositions[index];
          const pos = savedPosition ? 
            { top: savedPosition.top, left: savedPosition.left, rotate: '0deg' } : 
            defaultPositions[index % defaultPositions.length];
          
          const stickerDiv = document.createElement('div');
          stickerDiv.className = 'sticker';
          stickerDiv.style.backgroundImage = `url('${sticker}')`;
          stickerDiv.style.top = pos.top;
          stickerDiv.style.left = pos.left;
          stickerDiv.style.transform = `rotate(${pos.rotate})`;
          stickerDiv.setAttribute('data-sticker-index', index);
          stickerOverlay.appendChild(stickerDiv);
        });
        
        article.appendChild(stickerOverlay);
      }

      // Template tags
      const tagsDiv = document.createElement('div');
      tagsDiv.className = 'template-tags';
      tagsDiv.textContent = template.tags || '';

      // Use button
      const useBtn = document.createElement('button');
      useBtn.className = 'vertical-use-template-btn';
      useBtn.setAttribute('aria-label', 'Use this template');
      useBtn.type = 'button';
      useBtn.innerHTML = `<img src="Icons/2.svg" alt="Camera icon" /> Use this template`;
      useBtn.addEventListener('click', () => {
        alert(`Using template: ${template.name}`);
      });
      const iconsDiv = document.createElement('div');
      iconsDiv.className = 'vertical-template-icons';
      iconsDiv.setAttribute('role', 'group');
      iconsDiv.setAttribute('aria-label', 'Template controls');

      // Favorite button
      const favoriteBtn = document.createElement('button');
      favoriteBtn.type = 'button';
      favoriteBtn.setAttribute('aria-label', template.favorite ? 'Remove from favorites' : 'Add to favorites');
      favoriteBtn.setAttribute('title', template.favorite ? 'Remove from favorites' : 'Add to favorites');
      favoriteBtn.innerHTML = '<img src="Icons 2/save1.svg" alt="Favorite icon" />';
            if (template.favorite) {
        favoriteBtn.querySelector('img').classList.add('favorite-active');
      }
      
      favoriteBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        toggleSharedTemplateFavorite(template.id);
      });

      // Add only favorite button to icons container
      iconsDiv.appendChild(favoriteBtn);

      // Add drag events to the shared template card
      article.addEventListener('dragstart', (e) => {
        e.dataTransfer.setData('text/plain', template.id);
        e.dataTransfer.setData('template-type', 'shared');
        article.classList.add('dragging');
        e.dataTransfer.effectAllowed = 'copy';
      });
      
      article.addEventListener('dragend', () => {
        article.classList.remove('dragging');
      });

      // Assemble the card
      article.appendChild(photoContainer);
      article.appendChild(tagsDiv);
      article.appendChild(useBtn);
      article.appendChild(iconsDiv);

      return article;
    }

    // Function to create My Template card - VERTICAL DESIGN
    function createMyTemplateCard(template) {
      const article = document.createElement('article');
      article.className = 'vertical-template-card';
      article.draggable = true;
      article.dataset.templateId = template.id;
      article.dataset.templateType = 'my';
      
      // Set background image if available
      if (template.photos && template.photos.length > 0) {
        article.style.backgroundImage = `url('${template.photos[0]}')`;
      }
      
      article.setAttribute('aria-label', `My template: ${template.name}`);

      // Template photo container
      const photoContainer = document.createElement('div');
      photoContainer.className = 'template-photo-container';
      
      // Create photo layout based on shots
      const shots = parseInt(template.shots || 1);
      const frameSize = template.frameSize || '2x6';
      const effect = template.effect || 'none';
      
      if (shots === 1) {
        const photoDiv = document.createElement('div');
        photoDiv.className = `template-photo-single frame-${frameSize} effect-${effect}`;
        photoDiv.style.backgroundColor = 'rgba(255, 255, 255, 0.9)';
        
        photoContainer.appendChild(photoDiv);
      } else {
        const multipleContainer = document.createElement('div');
        multipleContainer.className = `template-photo-multiple ${shots}-shots frame-${frameSize}`;
        
        for (let i = 0; i < shots; i++) {
          const photoSlot = document.createElement('div');
          photoSlot.className = `photo-slot effect-${effect}`;
          photoSlot.style.backgroundColor = 'rgba(255, 255, 255, 0.9)';
          multipleContainer.appendChild(photoSlot);
        }
        
        photoContainer.appendChild(multipleContainer);
      }

      // Add stickers scattered across the entire card
      if (template.photos && template.photos.length > 1) {
        const stickerOverlay = document.createElement('div');
        stickerOverlay.className = 'sticker-overlay';
        
        // Use saved positions if available, otherwise use default positions
        const defaultPositions = [
          { top: '10%', left: '10%', rotate: '5deg' },
          { top: '15%', left: '80%', rotate: '-10deg' },
          { top: '50%', left: '20%', rotate: '15deg' },
          { top: '60%', left: '70%', rotate: '-5deg' },
          { top: '80%', left: '30%', rotate: '10deg' },
          { top: '85%', left: '85%', rotate: '-15deg' }
        ];
        
        template.photos.slice(1).forEach((sticker, index) => {
          const savedPosition = template.stickerPositions && template.stickerPositions[index];
          const pos = savedPosition ? 
            { top: savedPosition.top, left: savedPosition.left, rotate: '0deg' } : 
            defaultPositions[index % defaultPositions.length];
          
          const stickerDiv = document.createElement('div');
          stickerDiv.className = 'sticker';
          stickerDiv.style.backgroundImage = `url('${sticker}')`;
          stickerDiv.style.top = pos.top;
          stickerDiv.style.left = pos.left;
          stickerDiv.style.transform = `rotate(${pos.rotate})`;
          stickerDiv.setAttribute('data-sticker-index', index);
          stickerOverlay.appendChild(stickerDiv);
        });
        
        article.appendChild(stickerOverlay);
      }

      // Template tags
      const tagsDiv = document.createElement('div');
      tagsDiv.className = 'template-tags';
      tagsDiv.textContent = template.tags || '';

      // Use button
      const useBtn = document.createElement('button');
      useBtn.className = 'vertical-use-template-btn';
      useBtn.setAttribute('aria-label', 'Use this template');
      useBtn.type = 'button';
      useBtn.innerHTML = `<img src="Icons/2.svg" alt="Camera icon" /> Use this template`;
      useBtn.addEventListener('click', () => {
        alert(`Using template: ${template.name}`);
      });

      // Icon buttons - FAVORITE, EDIT, AND DELETE
      const iconsDiv = document.createElement('div');
      iconsDiv.className = 'vertical-template-icons';
      iconsDiv.setAttribute('role', 'group');
      iconsDiv.setAttribute('aria-label', 'Template controls');

      // Favorite button
      const favoriteBtn = document.createElement('button');
      favoriteBtn.type = 'button';
      favoriteBtn.setAttribute('aria-label', template.favorite ? 'Remove from favorites' : 'Add to favorites');
      favoriteBtn.setAttribute('title', template.favorite ? 'Remove from favorites' : 'Add to favorites');
      favoriteBtn.innerHTML = '<img src="Icons 2/save1.svg" alt="Favorite icon" />';
      
      // Add active class if template is favorited
      if (template.favorite) {
        favoriteBtn.querySelector('img').classList.add('favorite-active');
      }
      
      favoriteBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        toggleMyTemplateFavorite(template.id);
      });

      // EDIT BUTTON 
      const editBtn = document.createElement('button');
      editBtn.type = 'button';
      editBtn.setAttribute('aria-label', 'Edit template');
      editBtn.setAttribute('title', 'Edit template');
      editBtn.innerHTML = '<img src="Icons 2/btnedit1.svg" alt="Edit icon" />';
      editBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        alert(`Edit template: ${template.name}`);
      });

      // Delete button
      const deleteBtn = document.createElement('button');
      deleteBtn.type = 'button';
      deleteBtn.setAttribute('aria-label', 'Delete template');
      deleteBtn.setAttribute('title', 'Delete template');
      deleteBtn.innerHTML = '<img src="Icons 2/btndel1.svg" alt="Delete icon" />';
      deleteBtn.addEventListener('click', () => {
        if (confirm('Are you sure you want to delete this template?')) {
          state.myTemplates = state.myTemplates.filter(t => t.id !== template.id);
          renderMyTemplates();
          renderFavorites(); 
          addActivity(`Template "${template.name}" deleted from My Templates`);
        }
      });

      // Add buttons to icons container
      iconsDiv.appendChild(favoriteBtn);
      iconsDiv.appendChild(editBtn); 
      iconsDiv.appendChild(deleteBtn);

      // Add drag events to the my template card
      article.addEventListener('dragstart', (e) => {
        e.dataTransfer.setData('text/plain', template.id);
        e.dataTransfer.setData('template-type', 'my');
        article.classList.add('dragging');
        e.dataTransfer.effectAllowed = 'copy';
      });
      
      article.addEventListener('dragend', () => {
        article.classList.remove('dragging');
      });

      // Assemble the card
      article.appendChild(photoContainer);
      article.appendChild(tagsDiv);
      article.appendChild(useBtn);
      article.appendChild(iconsDiv);

      return article;
    }

    // Toggle shared template favorite
    function toggleSharedTemplateFavorite(templateId) {
      const template = sharedTemplates.find(t => t.id === templateId);
      if (template) {
        template.favorite = !template.favorite;
        renderSharedTemplates();
        renderFavorites();
        addActivity(`Template "${template.name}" ${template.favorite ? 'added to' : 'removed from'} favorites`);
      }
    }

    // Toggle my template favorite
    function toggleMyTemplateFavorite(templateId) {
      const template = state.myTemplates.find(t => t.id === templateId);
      if (template) {
        template.favorite = !template.favorite;
        renderMyTemplates();
        renderFavorites();
        addActivity(`Template "${template.name}" ${template.favorite ? 'added to' : 'removed from'} favorites`);
      }
    }

    // Render shared templates grid 
    function renderSharedTemplates() {
      const sharedContainer = document.querySelector('#tab-shared .vertical-templates-container');
      sharedContainer.innerHTML = '';
      
      if (sharedTemplates.length === 0) {
        sharedContainer.innerHTML = `
          <div class="empty-state">
            <img src="Icons 2/templates.svg" alt="No templates">
            <h3>No Shared Templates Yet</h3>
            <p>When community members share templates, they'll appear here.</p>
            <button onclick="alert('Creating your first template!')">Create Your First Template</button>
          </div>
        `;
      } else {
        sharedTemplates.forEach(tpl => {
          const card = createSharedTemplateCard(tpl);
          sharedContainer.appendChild(card);
        });
      }
    }

    // Function to render My Templates section
    function renderMyTemplates() {
      const myTemplatesContainer = document.querySelector('#tab-mytemplates .vertical-templates-container');
      
      // Always include the upload card first
      myTemplatesContainer.innerHTML = `
        <div class="template-upload-card" tabindex="0" role="button" aria-label="Upload your template" 
          id="open-upload-modal-btn"
          onkeydown="if(event.key==='Enter'||event.key===' ') { event.preventDefault(); alert('Upload template modal would open here'); }">
          <div class="plus-sign">+</div>
          Upload your template
        </div>
      `;

      // Add existing templates if any
      if (state.myTemplates && state.myTemplates.length > 0) {
        state.myTemplates.forEach(template => {
          const templateCard = createMyTemplateCard(template);
          myTemplatesContainer.appendChild(templateCard);
        });
      }
    }

    // Tab switching for templates
    const tabSharedBtn = document.getElementById('tab-shared-btn');
    const tabMyTemplatesBtn = document.getElementById('tab-mytemplates-btn');
    const tabShared = document.getElementById('tab-shared');
    const tabMyTemplates = document.getElementById('tab-mytemplates');

    tabSharedBtn.addEventListener('click', () => {
      tabShared.style.display = 'block';
      tabMyTemplates.style.display = 'none';
      tabSharedBtn.classList.add('active');
      tabSharedBtn.setAttribute('aria-selected', 'true');
      tabMyTemplatesBtn.classList.remove('active');
      tabMyTemplatesBtn.setAttribute('aria-selected', 'false');
      renderSharedTemplates();
    });

    tabMyTemplatesBtn.addEventListener('click', () => {
      tabShared.style.display = 'none';
      tabMyTemplates.style.display = 'block';
      tabMyTemplatesBtn.classList.add('active');
      tabMyTemplatesBtn.setAttribute('aria-selected', 'true');
      tabSharedBtn.classList.remove('active');
      tabSharedBtn.setAttribute('aria-selected', 'false');
      renderMyTemplates();
    });
    // Render favorites grid with vertical template design
    const favoritesContainer = document.getElementById('favoritesContainer');
    
    function renderFavorites() {
      favoritesContainer.innerHTML = '';
      
      // Combine favorites from both shared and my templates
      const sharedFavorites = sharedTemplates.filter(t => t.favorite);
      const myFavorites = state.myTemplates.filter(t => t.favorite);
      const allFavorites = [...sharedFavorites, ...myFavorites];
      
      if (allFavorites.length === 0) {
        const noFav = document.createElement('div');
        noFav.className = 'no-favorites-msg';
        noFav.textContent = 'No favorites yet. Click the heart icon on templates to add them to favorites, or drag templates here from the Feed.';
        favoritesContainer.appendChild(noFav);
        return;
      }
      
      // Create vertical template cards for each favorite
      allFavorites.forEach(template => {
        const templateCard = createFavoriteTemplateCard(template);
        favoritesContainer.appendChild(templateCard);
      });
      
      // Set up drag and drop functionality
      setupDragAndDrop();
    }

    // Create a favorite template card with vertical design
    function createFavoriteTemplateCard(template) {
      const article = document.createElement('article');
      article.className = 'vertical-template-card';
      article.draggable = true;
      article.dataset.templateId = template.id;
      article.dataset.templateType = template.shareToCommunity ? 'shared' : 'my';
      
      // Set background image if available
      if (template.photos && template.photos.length > 0) {
        article.style.backgroundImage = `url('${template.photos[0]}')`;
      }
      
      article.setAttribute('aria-label', `Favorite template: ${template.name}`);

      // Template photo container
      const photoContainer = document.createElement('div');
      photoContainer.className = 'template-photo-container';
      
      // Create photo layout based on shots
      const shots = parseInt(template.shots || 1);
      const frameSize = template.frameSize || '2x6';
      const effect = template.effect || 'none';
      
      if (shots === 1) {
        const photoDiv = document.createElement('div');
        photoDiv.className = `template-photo-single frame-${frameSize} effect-${effect}`;
        photoDiv.style.backgroundColor = 'rgba(255, 255, 255, 0.9)';
        
        photoContainer.appendChild(photoDiv);
      } else {
        const multipleContainer = document.createElement('div');
        multipleContainer.className = `template-photo-multiple ${shots}-shots frame-${frameSize}`;
        
        for (let i = 0; i < shots; i++) {
          const photoSlot = document.createElement('div');
          photoSlot.className = `photo-slot effect-${effect}`;
          photoSlot.style.backgroundColor = 'rgba(255, 255, 255, 0.9)';
          multipleContainer.appendChild(photoSlot);
        }
        
        photoContainer.appendChild(multipleContainer);
      }

      // Add stickers scattered across the entire card
      if (template.photos && template.photos.length > 1) {
        const stickerOverlay = document.createElement('div');
        stickerOverlay.className = 'sticker-overlay';
        
        // Use saved positions if available, otherwise use default positions
        const defaultPositions = [
          { top: '10%', left: '10%', rotate: '5deg' },
          { top: '15%', left: '80%', rotate: '-10deg' },
          { top: '50%', left: '20%', rotate: '15deg' },
          { top: '60%', left: '70%', rotate: '-5deg' },
          { top: '80%', left: '30%', rotate: '10deg' },
          { top: '85%', left: '85%', rotate: '-15deg' }
        ];
        
        template.photos.slice(1).forEach((sticker, index) => {
          const savedPosition = template.stickerPositions && template.stickerPositions[index];
          const pos = savedPosition ? 
            { top: savedPosition.top, left: savedPosition.left, rotate: '0deg' } : 
            defaultPositions[index % defaultPositions.length];
          
          const stickerDiv = document.createElement('div');
          stickerDiv.className = 'sticker';
          stickerDiv.style.backgroundImage = `url('${sticker}')`;
          stickerDiv.style.top = pos.top;
          stickerDiv.style.left = pos.left;
          stickerDiv.style.transform = `rotate(${pos.rotate})`;
          stickerDiv.setAttribute('data-sticker-index', index);
          stickerOverlay.appendChild(stickerDiv);
        });
        
        article.appendChild(stickerOverlay);
      }

      // Template tags
      const tagsDiv = document.createElement('div');
      tagsDiv.className = 'template-tags';
      tagsDiv.textContent = template.tags || '';

      // Use button
      const useBtn = document.createElement('button');
      useBtn.className = 'vertical-use-template-btn';
      useBtn.setAttribute('aria-label', 'Use this template');
      useBtn.type = 'button';
      useBtn.innerHTML = `<img src="Icons/2.svg" alt="Camera icon" /> Use this template`;
      useBtn.addEventListener('click', () => {
        alert(`Using favorite template: ${template.name}`);
      });

      // Icon buttons - FAVORITE (to remove from favorites) and DELETE (for my templates)
      const iconsDiv = document.createElement('div');
      iconsDiv.className = 'vertical-template-icons';
      iconsDiv.setAttribute('role', 'group');
      iconsDiv.setAttribute('aria-label', 'Favorite template controls');

      // Favorite button (to remove from favorites)
      const favoriteBtn = document.createElement('button');
      favoriteBtn.type = 'button';
      favoriteBtn.setAttribute('aria-label', 'Remove from favorites');
      favoriteBtn.setAttribute('title', 'Remove from favorites');
      favoriteBtn.innerHTML = '<img src="Icons 2/save1.svg" alt="Favorite icon" class="favorite-active" />';
      
      favoriteBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        removeFromFavorites(template.id, template.shareToCommunity);
      });

      // Delete button (only for my templates)
      if (!template.shareToCommunity) {
        const deleteBtn = document.createElement('button');
        deleteBtn.type = 'button';
        deleteBtn.setAttribute('aria-label', 'Delete template');
        deleteBtn.setAttribute('title', 'Delete template');
        deleteBtn.innerHTML = '<img src="Icons 2/btndel1.svg" alt="Delete icon" />';
        deleteBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          if (confirm('Are you sure you want to delete this template?')) {
            state.myTemplates = state.myTemplates.filter(t => t.id !== template.id);
            renderFavorites();
            renderMyTemplates();
            addActivity(`Template "${template.name}" deleted from My Templates`);
          }
        });
        iconsDiv.appendChild(deleteBtn);
      }

      // Add favorite button to icons container
      iconsDiv.appendChild(favoriteBtn);

      // Assemble the card
      article.appendChild(photoContainer);
      article.appendChild(tagsDiv);
      article.appendChild(useBtn);
      article.appendChild(iconsDiv);

      return article;
    }

    // Remove template from favorites
    function removeFromFavorites(templateId, isShared) {
      if (isShared) {
        const template = sharedTemplates.find(t => t.id === templateId);
        if (template) {
          template.favorite = false;
          addActivity(`Template "${template.name}" removed from favorites`);
        }
      } else {
        const template = state.myTemplates.find(t => t.id === templateId);
        if (template) {
          template.favorite = false;
          addActivity(`Template "${template.name}" removed from favorites`);
        }
      }
      
      renderFavorites();
      renderSharedTemplates();
      renderMyTemplates();
    }

    // Set up drag and drop functionality
    function setupDragAndDrop() {
      const favoriteCards = document.querySelectorAll('#favoritesContainer .vertical-template-card');
      
      favoriteCards.forEach(card => {
        // Drag start event
        card.addEventListener('dragstart', (e) => {
          e.dataTransfer.setData('text/plain', card.dataset.templateId);
          card.classList.add('dragging');
          e.dataTransfer.effectAllowed = 'move';
        });
        
        // Drag end event
        card.addEventListener('dragend', () => {
          card.classList.remove('dragging');
          favoritesContainer.classList.remove('drop-zone', 'active');
        });
      });
      
      // Drag over event for the favorites container
      favoritesContainer.addEventListener('dragover', (e) => {
        e.preventDefault();
        favoritesContainer.classList.add('drop-zone', 'active');
        e.dataTransfer.dropEffect = 'move';
      });
      
      // Drag leave event for the favorites container
      favoritesContainer.addEventListener('dragleave', (e) => {
        if (!favoritesContainer.contains(e.relatedTarget)) {
          favoritesContainer.classList.remove('drop-zone', 'active');
        }
      });
      
      // Drop event for the favorites container
      favoritesContainer.addEventListener('drop', (e) => {
        e.preventDefault();
        favoritesContainer.classList.remove('drop-zone', 'active');
        
        const templateId = parseInt(e.dataTransfer.getData('text/plain'));
        const templateType = e.dataTransfer.getData('template-type');
        
        // Find the template in the appropriate array
        let template;
        if (templateType === 'shared') {
          template = sharedTemplates.find(t => t.id === templateId);
        } else {
          template = state.myTemplates.find(t => t.id === templateId);
        }
        
        if (template && !template.favorite) {
          template.favorite = true;
          addActivity(`Template "${template.name}" added to favorites`);
          renderFavorites();
          renderSharedTemplates();
          renderMyTemplates();
        }
      });
    }
    // ADMIN DASHBOARD CODE

    // Tab switching - Independent from sidebar
    const subnav = document.querySelector('.subnav');
    
    function showTab(idx) {
      let subnavBtns = document.querySelectorAll('.subnav button');
      let panels = document.querySelectorAll('.tab-panel');
      
      // Hide all sections first
      document.getElementById('section-feed').style.display = 'none';
      document.getElementById('section-favorites').style.display = 'none';
      document.getElementById('section-activity').style.display = 'none';
      
      // Show the subnav when admin tabs are clicked
      subnav.style.display = 'flex';
      
      // Update subnav buttons
      subnavBtns.forEach((btn, i) => {
        btn.classList.toggle('active', i === idx);
        btn.setAttribute('aria-selected', (i === idx).toString());
        panels[i].style.display = i === idx ? 'block' : 'none';
      });
      
      // Reset sidebar to feed (default)
      document.querySelectorAll('.left-buttons button').forEach(btn => {
        btn.classList.remove('active');
      });
      document.querySelector('[data-target="feed"]').classList.add('active');
    }

    document.addEventListener('DOMContentLoaded', function() {
      showTab(0);
      // Initialize feed section
      copyFirstTemplateToMyTemplates();
      renderSharedTemplates();
      renderMyTemplates();
      renderFavorites();
      renderActivity();
    });

    // Sidebar navigation - Independent from subnav
    const sidebarButtons = document.querySelectorAll('.left-buttons button');

    sidebarButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        const target = btn.dataset.target;

        if (target === 'logout') {
          alert('Logging out...');
          // Redirect to finalprof.html with logout action (assuming finalprof handles the actual sign-out)
          window.location.href = 'finalprof.html?action=logout';
          return;
        }

        
       
        window.location.href = `finalprof.html?target=${target}`;
        

      });
    });

    // Activity log
    const activityContainer = document.querySelector('.activity-container');
    function addActivity(desc) {
      const now = new Date();
      const timestamp = now.toLocaleString();
      state.activities.unshift({ desc, timestamp });
      if (state.activities.length > 50) state.activities.length = 50;
      renderActivity();
    }

    function renderActivity() {
      activityContainer.innerHTML = '';
      if (state.activities.length === 0) {
        const emptyDiv = document.createElement('div');
        emptyDiv.className = 'activity-post empty';
        emptyDiv.textContent = 'No activity yet.';
        activityContainer.appendChild(emptyDiv);
        return;
      }
      state.activities.forEach(act => {
        const post = document.createElement('div');
        post.className = 'activity-post';
        post.textContent = `${act.desc}\n${act.timestamp}`;
        activityContainer.appendChild(post);
      });
    }

    // Add some sample activities
    addActivity('Profile picture updated');
    addActivity('Photo 1 added to favorites');
    addActivity('New comment on photo 2');

    // Modal functions (simplified for demo)
    function openModal() {
      document.getElementById('uploadModal').style.display = 'flex';
    }
    
    function closeModal() {
      document.getElementById('uploadModal').style.display = 'none';
    }
    
    function openDeleteModal(templateName) {
      document.getElementById('deleteModal').style.display = 'flex';
      document.getElementById('deleteMessage').textContent = `Are you sure you want to permanently delete "${templateName}"?`;
    }
    
    function closeDeleteModal() {
      document.getElementById('deleteModal').style.display = 'none';
    }
    
    function confirmDelete() {
      alert('Template deleted!');
      closeDeleteModal();
    }

    // Example template data for modals
    const exampleFilterTemplate = {
      name: 'Warm Filter',
      type: 'Filter',
      tags: 'warm, soft, light',
      usageCount: 159,
      status: 'Active',
      dateAdded: '2025-11-10'
    };

    const exampleBackgroundTemplate = {
      name: 'Sunset Background',
      type: 'Background',
      tags: 'sunset, nature, warm',
      usageCount: 42,
      status: 'Active',
      dateAdded: '2025-11-12'
    };

    function openViewModal(template) {
      document.getElementById('viewModal').style.display = 'flex';
      document.getElementById('viewTemplateName').value = template.name;
      document.getElementById('viewTags').value = template.tags;
      document.getElementById('viewType').value = template.type;
      document.getElementById('viewUsageCount').value = template.usageCount;
      document.getElementById('viewUploader').value = `Admin - ${template.dateAdded}`;
    }

    function closeViewModal() {
      document.getElementById('viewModal').style.display = 'none';
    }

    function openEditModal(template) {
      document.getElementById('editModal').style.display = 'flex';
      document.getElementById('editTemplateName').value = template.name;
      document.getElementById('editTags').value = template.tags;
      document.getElementById('editType').value = template.type;
      document.getElementById('editUsageCount').textContent = `Usage Count: ${template.usageCount} times`;
      document.getElementById('editStatus').value = template.status;
    }

    function closeEditModal() {
      document.getElementById('editModal').style.display = 'none';
    }

    function saveChanges() {
      alert('Changes saved!');
      closeEditModal();
    }

    // User management functions
    function switchTab(tabName) {
      document.getElementById('accountDetailsContent').style.display = tabName === 'accountDetails' ? 'block' : 'none';
      document.getElementById('activityContentsContent').style.display = tabName === 'activityContents' ? 'block' : 'none';
      
      document.getElementById('accountDetailsTab').classList.toggle('active', tabName === 'accountDetails');
      document.getElementById('activityContentsTab').classList.toggle('active', tabName === 'activityContents');
    }

    function closeManageUserModal() {
      document.getElementById('manageUserModal').style.display = 'none';
    }

    function saveChangesUser() {
      alert('User changes saved!');
      closeManageUserModal();
    }

    function closeDeleteUserModal() {
      document.getElementById('deleteUserModal').style.display = 'none';
    }

    function confirmDeleteUser() {
      alert('User deleted!');
      closeDeleteUserModal();
    }

    // Add event listeners for manage links
    document.querySelectorAll('.manage-link').forEach(link => {
      link.addEventListener('click', function() {
        document.getElementById('manageUserModal').style.display = 'flex';
      });
    });

    // Add event listener for delete user button
    document.getElementById('deleteUserBtn').addEventListener('click', function() {
      document.getElementById('deleteUserModal').style.display = 'flex';
    });
  </script>
</body>
</html>